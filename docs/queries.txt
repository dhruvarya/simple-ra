Q1a <- CROSS EMPLOYEE DEPARTMENT
Q1b <- SELECT Super_ssn == Mgr_ssn FROM Q1a
Q1c <- SELECT Dno == Dnumber FROM Q1b
RENAME Dnumber TO Super_dno FROM Q1c
Q1 <- PROJECT Ssn, Dno, Super_ssn, Super_dno FROM Q1c
CLEAR Q1a
CLEAR Q1b
CLEAR Q1c
EXPORT Q1

Q2a <- CROSS EMPLOYEE WORKS_ON
Q2b <- SELECT Ssn == Essn FROM Q2a
Q2c <- CROSS Q2b PROJECT
Q2d <- SELECT Pno == Pnumber FROM Q2c
Q2e <- SELECT Dno == Dnum FROM Q2d
RENAME Dnum TO P_dno FROM Q2e
Q2 <- PROJECT Ssn, Dno, Pno, P_dno FROM Q2e
CLEAR Q2a
CLEAR Q2b
CLEAR Q2c
CLEAR Q2d
CLEAR Q2e
EXPORT Q2

Q3a <- CROSS EMPLOYEE WORKS_ON
Q3b <- SELECT Ssn == Essn FROM Q3a
Q3c <- CROSS Q3b PROJECT
Q3d <- SELECT Dno != Dnum FROM Q3c
Q3e <- SELECT Pno == Pnumber FROM Q3d
RENAME Dnum TO P_dno FROM Q3e
Q3 <- PROJECT Ssn, Dno, Pno, P_dno FROM Q3e
CLEAR Q3a
CLEAR Q3b
CLEAR Q3c
CLEAR Q3d
CLEAR Q3e
EXPORT Q3

Q4a <- CROSS EMPLOYEE EMPLOYEE
Q4b <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM Q4a
Q4c <- SELECT EMPLOYEE1_Bdate > EMPLOYEE2_Bdate FROM Q4b
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q4c
RENAME EMPLOYEE2_Bdate TO Super_bdate FROM Q4c
RENAME EMPLOYEE1_Ssn TO Essn FROM Q4c
RENAME EMPLOYEE1_Bdate TO E_bdate FROM Q4c
Q4 <- PROJECT Super_ssn, Super_bdate, Essn, E_bdate FROM Q4c
CLEAR Q4a
CLEAR Q4b
CLEAR Q4c
EXPORT Q4

Q5a <- CROSS EMPLOYEE EMPLOYEE 
Q5b <- SELECT EMPLOYEE1_Sex != EMPLOYEE2_Sex FROM Q5a
Q5c <- SELECT EMPLOYEE1_Dno == EMPLOYEE2_Dno FROM Q5b
RENAME EMPLOYEE1_Dno TO Dno FROM Q5c
Q5 <- PROJECT Dno FROM Q5c
CLEAR Q5a
CLEAR Q5b
CLEAR Q5c
EXPORT Q5

QUIT